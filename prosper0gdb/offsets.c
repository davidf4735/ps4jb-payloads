#include "r0gdb.h"
#include "offsets.h"

struct offset_table offsets;
extern uint64_t kdata_base;

#define OFFSET(x) offsets.x = kdata_base + x;
#define DEF(x, y) enum { x = (y) + 0 * sizeof(offsets.x) };

#define START_FW(fw) void set_offsets_ ## fw(void) {
#define END_FW() }

START_FW(300)
DEF(allproc, 0x276dc58)
DEF(idt, 0x642dc80)
DEF(gdt_array, 0x642ee20)
DEF(tss_array, 0x6430820)
DEF(pcpu_array, 0x6432280)
DEF(doreti_iret, -0x9aefbc)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x96f79a)
DEF(rdmsr_start, -0x9b046a)
DEF(wrmsr_ret, -0x9b183c)
DEF(dr2gpr_start, -0x9b6513)
DEF(gpr2dr_1_start, -0x9b63fa)
DEF(gpr2dr_2_start, -0x9b6307)
DEF(mov_cr3_rax_mov_ds, -0x9b5f69)

//DEF(mov_rdi_cr3, -0x390a0e)
DEF(mov_rax_cr3, -0x38C020) //??

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0x9b6700)
DEF(mprotect_fix_start, -0x8ee651)
DEF(mprotect_fix_end, mprotect_fix_start+6)
DEF(mmap_self_fix_1_start, -0x2c92bd)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, -0x1dd21e)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x8409F0)
DEF(aslr_fix_end, -0x8409B0)

DEF(sigaction_fix_start, -0x6b549f)
DEF(sigaction_fix_end, -0x6b5449)
DEF(sysents, 0x16f720)
DEF(sysents_ps4, 0x167170)
DEF(sysentvec, 0xca0cd8)
DEF(sysentvec_ps4, 0xca0e50)
DEF(sceSblServiceMailbox, -0x675df0)
DEF(sceSblAuthMgrSmIsLoadable2, -0x88a540)
DEF(mdbg_call_fix, -0x626d49)
DEF(syscall_before, -0x7e91bf)
DEF(syscall_after, -0x7e919c)
DEF(malloc, -0xaa2a0)
DEF(M_something, 0x12d3d70)
DEF(loadSelfSegment_epilogue, -0x889e0d)
DEF(loadSelfSegment_watchpoint, -0x2c88a8)
DEF(loadSelfSegment_watchpoint_lr, -0x88a067)
DEF(decryptSelfBlock_watchpoint_lr, -0x889cca)
DEF(decryptSelfBlock_epilogue, -0x889c03)
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x889595)
DEF(decryptMultipleSelfBlocks_epilogue, -0x889112)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x88a1bc)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x889e81)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x889954)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8891cc)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x88a5be)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x92d9b0)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x92df7b)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x92df05)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x92dc60)
DEF(sceSblServiceCryptAsync, -0x8d1e30)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x8d1df2)
DEF(copyin, -0x970050)
DEF(copyout, -0x970100)
DEF(crypt_message_resolve, -0x475790)
DEF(justreturn, -0x9af100)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xd4fe88)
DEF(pop_all_iret, -0x9af01b)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x94f570)
DEF(kernel_pmap_store, 0x31be218)
DEF(crypt_singleton_array, 0x2d99830)
DEF(security_flags, 0x6466474)
DEF(targetid, 0x646647d)
DEF(qa_flags, 0x6466498)
DEF(utoken, 0x6466500)
DEF(mov_rax_cr0, -0x9b6661)
DEF(mov_cr0_rax, -0x9b665c)
DEF(mov_rdi_cr2, -0x9b20da)
DEF(lgdt_rdi, -0x96f970)
DEF(lidt_lldt, -0x9b5eb1)
DEF(ltr_ax, -0x9b5e8f)
DEF(kproc_shutdown, -0x94a808)
DEF(s_shutdown_final, 0x320f85)
DEF(eventhandler_register, -0x51f770)
DEF(strlen_trap, -0x441958)
DEF(lapic_map, 0x27c6f40)
#include "offset_list.txt"
END_FW()

START_FW(310)
DEF(allproc, 0x276dc58)
DEF(idt, 0x642dc80)
DEF(gdt_array, 0x642ee20)
DEF(tss_array, 0x6430820)
DEF(pcpu_array, 0x6432280)
DEF(doreti_iret, -0x9aefbc)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x96f79a)
DEF(rdmsr_start, -0x9b046a)
DEF(wrmsr_ret, -0x9b183c)
DEF(dr2gpr_start, -0x9b6513)
DEF(gpr2dr_1_start, -0x9b63fa)
DEF(gpr2dr_2_start, -0x9b6307)
DEF(mov_cr3_rax_mov_ds, -0x9b5f69)

//DEF(mov_rdi_cr3, -0x3909ce)
DEF(mov_rax_cr3, -0x38BFE0)

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0x9b6700)
DEF(mprotect_fix_start, -0x8ee651)
DEF(mprotect_fix_end, mprotect_fix_start+6)
DEF(mmap_self_fix_1_start, -0x2c927d)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, -0x1dd1de)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x8409B0)
DEF(aslr_fix_end, -0x840970)

DEF(sigaction_fix_start, -0x6b545f)
DEF(sigaction_fix_end, -0x6b5409)
DEF(sysents, 0x16f720)
DEF(sysents_ps4, 0x167170)
DEF(sysentvec, 0xca0cd8)
DEF(sysentvec_ps4, 0xca0e50)
DEF(sceSblServiceMailbox, -0x675db0)
DEF(sceSblAuthMgrSmIsLoadable2, -0x88a540)
DEF(mdbg_call_fix, -0x626d09)
DEF(syscall_before, -0x7e917f)
DEF(syscall_after, -0x7e915c)
DEF(malloc, -0xaa260)
DEF(M_something, 0x12d3d70)
DEF(loadSelfSegment_epilogue, -0x889dcd)
DEF(loadSelfSegment_watchpoint, -0x2c8868)
DEF(loadSelfSegment_watchpoint_lr, -0x88a027)
DEF(decryptSelfBlock_watchpoint_lr, -0x889c8a)
DEF(decryptSelfBlock_epilogue, -0x889bc3)
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x889555)
DEF(decryptMultipleSelfBlocks_epilogue, -0x8890d2)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x88a1bc)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x889e41)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x889914)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x88918c)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x88a5be)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x92d9b0)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x92df7b)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x92df05)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x92dc60)
DEF(sceSblServiceCryptAsync, -0x8d1e30)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x8d1df2)
DEF(copyin, -0x970050)
DEF(copyout, -0x970100)
DEF(crypt_message_resolve, -0x475750)
DEF(justreturn, -0x9af100)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xd4fe88)
DEF(pop_all_iret, -0x9af01b)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x94f6b8)
DEF(kernel_pmap_store, 0x31be218)
DEF(crypt_singleton_array, 0x2d99830)
DEF(security_flags, 0x6466474)
DEF(targetid, 0x646647d)
DEF(qa_flags, 0x6466490)
DEF(utoken, 0x6466500)
DEF(mov_rax_cr0, -0x9b6661)
DEF(mov_cr0_rax, -0x9b665c)
DEF(mov_rdi_cr2, -0x9b20da)
DEF(lgdt_rdi, -0x96f970)
DEF(lidt_lldt, -0x9b5eb1)
DEF(ltr_ax, -0x9b5e8f)
DEF(kproc_shutdown, -0x94a730)
DEF(s_shutdown_final, 0x320be0)
DEF(eventhandler_register, -0x51f730)
DEF(strlen_trap, -0x441918)
DEF(lapic_map, 0x27c6f40)
#include "offset_list.txt"
END_FW()

START_FW(320)
DEF(allproc, 0x276dc58)
DEF(idt, 0x642dc80)
DEF(gdt_array, 0x642ee20)
DEF(tss_array, 0x6430820)
DEF(pcpu_array, 0x6432280)
DEF(doreti_iret, -0x9aec7c)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x96f45a)
DEF(rdmsr_start, -0x9b012a)
DEF(wrmsr_ret, -0x9b14fc)
DEF(dr2gpr_start, -0x9b61d3)
DEF(gpr2dr_1_start, -0x9b60ba)
DEF(gpr2dr_2_start, -0x9b5fc7)
DEF(mov_cr3_rax_mov_ds, -0x9b5c29)

//DEF(mov_rdi_cr3, -0x39067e)
DEF(mov_rax_cr3, -0x38BC90)

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0x9b63c0)
DEF(mprotect_fix_start, -0x8ee311)
DEF(mprotect_fix_end, mprotect_fix_start+6)
DEF(mmap_self_fix_1_start, -0x2c8f2d)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, -0x1dcd1e)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x840660)
DEF(aslr_fix_end, -0x840620)

DEF(sigaction_fix_start, -0x6b510f)
DEF(sigaction_fix_end, -0x6b50b9)
DEF(sysents, 0x16f720)
DEF(sysents_ps4, 0x167170)
DEF(sysentvec, 0xca0cd8)
DEF(sysentvec_ps4, 0xca0e50)
DEF(sceSblServiceMailbox, -0x675a60)
DEF(sceSblAuthMgrSmIsLoadable2, -0x88a200)
DEF(mdbg_call_fix, -0x6269b9)
DEF(syscall_before, -0x7e8e2f)
DEF(syscall_after, -0x7e8e0c)
DEF(malloc, -0xa9da0)
DEF(M_something, 0x12d3d70)
DEF(loadSelfSegment_epilogue, -0x889a7d)
DEF(loadSelfSegment_watchpoint, -0x2c8518)
DEF(loadSelfSegment_watchpoint_lr, -0x889cd7)
DEF(decryptSelfBlock_watchpoint_lr, -0x88993a)
DEF(decryptSelfBlock_epilogue, -0x889873)
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x889205)
DEF(decryptMultipleSelfBlocks_epilogue, -0x888d82)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x889e7c)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x889af1)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8895c4)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x888e3c)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x88a27e)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x92d670)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x92dc3b)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x92dbc5)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x92d920)
DEF(sceSblServiceCryptAsync, -0x8d1af0)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x8d1ab2)
DEF(copyin, -0x96fd10)
DEF(copyout, -0x96fdc0)
DEF(crypt_message_resolve, -0x475400)
DEF(justreturn, -0x9aedc0)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xd4fe88)
DEF(pop_all_iret, -0x9aecdb)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x94e7d0)
DEF(kernel_pmap_store, 0x31be218)
DEF(crypt_singleton_array, 0x2d99830)
DEF(security_flags, 0x6466474)
DEF(targetid, 0x646647d)
DEF(qa_flags, 0x6466498)
DEF(utoken, 0x6466500)
DEF(mov_rax_cr0, -0x9b6321)
DEF(mov_cr0_rax, -0x9b631c)
DEF(mov_rdi_cr2, -0x9b1d9a)
DEF(lgdt_rdi, -0x96f630)
DEF(lidt_lldt, -0x9b5b71)
DEF(ltr_ax, -0x9b5b4f)
DEF(kproc_shutdown, -0x94a3f8)
DEF(s_shutdown_final, 0x320eda)
DEF(eventhandler_register, -0x51f3e0)
DEF(strlen_trap, -0x4415c8)
DEF(lapic_map, 0x27c6f40)
#include "offset_list.txt"
END_FW()

START_FW(321)
DEF(allproc, 0x276dc58)
DEF(idt, 0x642dc80)
DEF(gdt_array, 0x642ee20)
DEF(tss_array, 0x6430820)
DEF(pcpu_array, 0x6432280)
DEF(doreti_iret, -0x9aec7c)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x96f45a)
DEF(rdmsr_start, -0x9b012a)
DEF(wrmsr_ret, -0x9b14fc)
DEF(dr2gpr_start, -0x9b61d3)
DEF(gpr2dr_1_start, -0x9b60ba)
DEF(gpr2dr_2_start, -0x9b5fc7)
DEF(mov_cr3_rax_mov_ds, -0x9b5c29)

//DEF(mov_rdi_cr3, -0x39067e)
DEF(mov_rax_cr3, -0x38BC90)

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0x9b63c0)
DEF(mprotect_fix_start, -0x8ee311)
DEF(mprotect_fix_end, mprotect_fix_start+6)
DEF(mmap_self_fix_1_start, -0x2c8f2d)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, -0x1dcd1e)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x840660)
DEF(aslr_fix_end, -0x840620)
										  				
DEF(sigaction_fix_start, -0x6b510f)
DEF(sigaction_fix_end, -0x6b50b9)
DEF(sysents, 0x16f720)
DEF(sysents_ps4, 0x167170)
DEF(sysentvec, 0xca0cd8)
DEF(sysentvec_ps4, 0xca0e50)
DEF(sceSblServiceMailbox, -0x675a60)
DEF(sceSblAuthMgrSmIsLoadable2, -0x88a200)
DEF(mdbg_call_fix, -0x6269b9)
DEF(syscall_before, -0x7e8e2f)
DEF(syscall_after, -0x7e8e0c)
DEF(malloc, -0xa9da0)
DEF(M_something, 0x12d3d70)
DEF(loadSelfSegment_epilogue, -0x889a7d)
DEF(loadSelfSegment_watchpoint, -0x2c8518)
DEF(loadSelfSegment_watchpoint_lr, -0x889cd7)
DEF(decryptSelfBlock_watchpoint_lr, -0x88993a)
DEF(decryptSelfBlock_epilogue, -0x889873)
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x889205)
DEF(decryptMultipleSelfBlocks_epilogue, -0x888d82)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x889e7c)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x889af1)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8895c4)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x888e3c)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x88a27e)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x92d670)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x92dc3b)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x92dbc5)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x92d920)
DEF(sceSblServiceCryptAsync, -0x8d1af0)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x8d1ab2)
DEF(copyin, -0x96fd10)
DEF(copyout, -0x96fdc0)
DEF(crypt_message_resolve, -0x475400)
DEF(justreturn, -0x9aedc0)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xd4fe88)
DEF(pop_all_iret, -0x9aecdb)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x94e4d0)
DEF(kernel_pmap_store, 0x31be218)
DEF(crypt_singleton_array, 0x2d99830)
DEF(security_flags, 0x6466474)
DEF(targetid, 0x646647d)
DEF(qa_flags, 0x6466498)
DEF(utoken, 0x6466500)
DEF(mov_rax_cr0, -0x9b6321)
DEF(mov_cr0_rax, -0x9b631c)
DEF(mov_rdi_cr2, -0x9b1d9a)
DEF(lgdt_rdi, -0x96f630)
DEF(lidt_lldt, -0x9b5b71)
DEF(ltr_ax, -0x9b5b4f)
DEF(kproc_shutdown, -0x94ac48)
DEF(s_shutdown_final, 0x320cb3)
DEF(eventhandler_register, -0x51f3e0)
DEF(strlen_trap, -0x4415c8)
DEF(lapic_map, 0x27c6f40)
#include "offset_list.txt"
END_FW()

START_FW(400)
DEF(allproc, 0x27edcb8)
DEF(idt, 0x64cdc80)
DEF(gdt_array, 0x64cee30)
DEF(tss_array, 0x64d0830)
DEF(pcpu_array, 0x64d2280)
DEF(doreti_iret, -0x9cf84c)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x99002a)
DEF(rdmsr_start, -0x9d0cfa)
DEF(wrmsr_ret, -0x9d20cc)
DEF(dr2gpr_start, -0x9d6d93)
DEF(gpr2dr_1_start, -0x9d6c7a)
DEF(gpr2dr_2_start, -0x9d6b87)
DEF(mov_cr3_rax_mov_ds, -0x9d67e9)

//DEF(mov_rdi_cr3, -0x3970ee)
DEF(mov_rax_cr3, -0x392770) //??

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0x9d6f80)
DEF(mprotect_fix_start, -0x90ac61)
DEF(mprotect_fix_end, mprotect_fix_start+6)
DEF(mmap_self_fix_1_start, -0x2cd3fd)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, -0x1df3ae)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x85a312)
DEF(aslr_fix_end, -0x85a2d2)

DEF(sigaction_fix_start, -0x6c2989)
DEF(sigaction_fix_end, -0x6c2933)
DEF(sysents, 0x1709c0)
DEF(sysents_ps4, 0x168410)
DEF(sysentvec, 0xd11bb8)
DEF(sysentvec_ps4, 0xd11d30)
DEF(sceSblServiceMailbox, -0x6824c0)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8a5c40)
DEF(mdbg_call_fix, -0x631eb9)
DEF(syscall_before, -0x802311)
DEF(syscall_after, -0x8022ee)
DEF(malloc, -0xa9be0)
DEF(M_something, 0x1346080)
DEF(loadSelfSegment_epilogue, -0x8a54cd)
DEF(loadSelfSegment_watchpoint, -0x2cc9f8)
DEF(loadSelfSegment_watchpoint_lr, -0x8a5727)
DEF(decryptSelfBlock_watchpoint_lr, -0x8a538a)
DEF(decryptSelfBlock_epilogue, -0x8a52c3)
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8a4c55)
DEF(decryptMultipleSelfBlocks_epilogue, -0x8a47d2)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8a58bc)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8a5541)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8a5014)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8a488c)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8a5cbe)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x94a7f0)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x94ada4)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x94ad2e)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x94aaa0)
DEF(sceSblServiceCryptAsync, -0x8ed940)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x8ed902)
DEF(copyin, -0x9908e0)
DEF(copyout, -0x990990)
DEF(crypt_message_resolve, -0x479e40)
DEF(justreturn, -0x9cf990)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xdc16e8)
DEF(pop_all_iret, -0x9cf8ab)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x96bc30)
DEF(kernel_pmap_store, 0x3257a78)
DEF(crypt_singleton_array, 0x2e31830)
DEF(security_flags, 0x6506474)
DEF(targetid, 0x650647d)
DEF(qa_flags, 0x6506498)
DEF(utoken, 0x6506500)
DEF(mov_rax_cr0, -0x9d6ee1)
DEF(mov_cr0_rax, -0x9d6edc)
DEF(mov_rdi_cr2, -0x9d296a)
DEF(lgdt_rdi, -0x990200)
DEF(lidt_lldt, -0x9d6731)
DEF(ltr_ax, -0x9d670f)
DEF(kproc_shutdown, -0x96af88)
DEF(s_shutdown_final, 0x322c23)
DEF(eventhandler_register, -0x525900)
DEF(strlen_trap, -0x44a9f8)
DEF(lapic_map, 0x2846fa0)
#include "offset_list.txt"
END_FW()

START_FW(402)
DEF(allproc, 0x27edcb8)
DEF(idt, 0x64cdc80)
DEF(gdt_array, 0x64cee30)
DEF(tss_array, 0x64d0830)
DEF(pcpu_array, 0x64d2280)
DEF(doreti_iret, -0x9cf84c)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x99002a)
DEF(rdmsr_start, -0x9d0cfa)
DEF(wrmsr_ret, -0x9d20cc)
DEF(dr2gpr_start, -0x9d6d93)
DEF(gpr2dr_1_start, -0x9d6c7a)
DEF(gpr2dr_2_start, -0x9d6b87)
DEF(mov_cr3_rax_mov_ds, -0x9d67e9)

//DEF(mov_rdi_cr3, -0x39709e)
DEF(mov_rax_cr3, -0x392720) //??

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0x9d6f80)
DEF(mprotect_fix_start, -0x90ac61)
DEF(mprotect_fix_end, mprotect_fix_start+6)
DEF(mmap_self_fix_1_start, -0x2cd3ad)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, -0x1df35e)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x85a312)
DEF(aslr_fix_end, -0x85a2d2)

DEF(sigaction_fix_start, -0x6c2989)
DEF(sigaction_fix_end, -0x6c2933)
DEF(sysents, 0x1709c0)
DEF(sysents_ps4, 0x168410)
DEF(sysentvec, 0xd11bb8)
DEF(sysentvec_ps4, 0xd11d30)
DEF(sceSblServiceMailbox, -0x6824c0)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8a5c40)
DEF(mdbg_call_fix, -0x631e99)
DEF(syscall_before, -0x802311)
DEF(syscall_after, -0x8022ee)
DEF(malloc, -0xa9b90)
DEF(M_something, 0x1346080)
DEF(loadSelfSegment_epilogue, -0x8a54cd)
DEF(loadSelfSegment_watchpoint, -0x2cc9a8)
DEF(loadSelfSegment_watchpoint_lr, -0x8a5727)
DEF(decryptSelfBlock_watchpoint_lr, -0x8a538a)
DEF(decryptSelfBlock_epilogue, -0x8a52c3)
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8a4c55)
DEF(decryptMultipleSelfBlocks_epilogue, -0x8a47d2)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8a58bc)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8a5541)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8a5014)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8a488c)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8a5cbe)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x94a7f0)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x94ada4)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x94ad2e)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x94aaa0)
DEF(sceSblServiceCryptAsync, -0x8ed940)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x8ed902)
DEF(copyin, -0x9908e0)
DEF(copyout, -0x990990)
DEF(crypt_message_resolve, -0x479df0)
DEF(justreturn, -0x9cf990)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xdc16e8)
DEF(pop_all_iret, -0x9cf8ab)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x96d208)
DEF(kernel_pmap_store, 0x3257a78)
DEF(crypt_singleton_array, 0x2e31830)
DEF(security_flags, 0x6505474)
DEF(targetid, 0x650547d)
DEF(qa_flags, 0x6505498)
DEF(utoken, 0x6505500)
DEF(mov_rax_cr0, -0x9d6ee1)
DEF(mov_cr0_rax, -0x9d6edc)
DEF(mov_rdi_cr2, -0x9d296a)
DEF(lgdt_rdi, -0x990200)
DEF(lidt_lldt, -0x9d6731)
DEF(ltr_ax, -0x9d670f)
DEF(kproc_shutdown, 0)
DEF(s_shutdown_final, 0)
DEF(eventhandler_register, 0)
DEF(strlen_trap, 0)
DEF(lapic_map, 0x2846fa0)
#include "offset_list.txt"
END_FW()

START_FW(403)
DEF(allproc, 0x27edcb8)
DEF(idt, 0x64cdc80)
DEF(gdt_array, 0x64cee30)
DEF(tss_array, 0x64d0830)
DEF(pcpu_array, 0x64d2280)
DEF(doreti_iret, -0x9cf84c)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x99002a /*-0x990a55*/)
DEF(rdmsr_start, -0x9d0cfa /*-0x9d6d02*/)
//DEF(rdmsr_end, -0x9d6cf9)
DEF(wrmsr_ret, -0x9d20cc)
DEF(dr2gpr_start, -0x9d6d93)
//DEF(dr2gpr_end, -0x9d6d7c)
DEF(gpr2dr_1_start, -0x9d6c7a)
//DEF(gpr2dr_1_end, -0x9d6c55)
DEF(gpr2dr_2_start, -0x9d6b87)
//DEF(gpr2dr_2_end, -0x9d6de9)
DEF(mov_cr3_rax_mov_ds, -0x9d67e9)

//DEF(mov_rdi_cr3, -0x39700e)
DEF(mov_rax_cr3, -0x392690)

DEF(nop_ret, wrmsr_ret + 2 /*-0x28a3a0*/)
DEF(cpu_switch, -0x9d6f80)
DEF(mprotect_fix_start, -0x90ac61)
DEF(mprotect_fix_end, mprotect_fix_start+6)
DEF(mmap_self_fix_1_start, -0x2cd31d)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, -0x1df2ce)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x85a312)
DEF(aslr_fix_end, -0x85a2d2)

DEF(sigaction_fix_start, -0x6c2989)
DEF(sigaction_fix_end, -0x6c2933)
DEF(sysents, 0x1709c0)
DEF(sysents_ps4, 0x168410)
DEF(sysentvec, 0xd11bb8)
DEF(sysentvec_ps4, 0xd11d30)
DEF(sceSblServiceMailbox, -0x6824c0)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8a5c40)
DEF(mdbg_call_fix, -0x631ea9)
DEF(syscall_before, -0x802311)
DEF(syscall_after, -0x8022ee)
DEF(malloc, -0xa9b00)
DEF(M_something, 0x1346080)
DEF(loadSelfSegment_epilogue, -0x8a54cd)
DEF(loadSelfSegment_watchpoint, -0x2cc918)
DEF(loadSelfSegment_watchpoint_lr, -0x8a5727)
DEF(decryptSelfBlock_watchpoint_lr, -0x8a538a)
DEF(decryptSelfBlock_epilogue, -0x8a52c3)
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8a4c55)
DEF(decryptMultipleSelfBlocks_epilogue, -0x8a47d2)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8a58bc)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8a5541)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8a5014)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8a488c)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8a5cbe)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x94a7f0)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x94ada4)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x94ad2e)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, -0x3189EE)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, -0x31873A)
DEF(sceSblPfsSetKeys, -0x94aaa0)
//DEF(panic, -0x21020)
DEF(sceSblServiceCryptAsync, -0x8ed940)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x8ed902)
DEF(copyin, -0x9908e0)
DEF(copyout, -0x990990)
DEF(crypt_message_resolve, -0x479d60)
DEF(justreturn, -0x9cf990)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xdc16e8)
DEF(pop_all_iret, -0x9cf8ab)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x96be70)
DEF(kernel_pmap_store, 0x3257a78)
DEF(crypt_singleton_array, 0x2e31830)
DEF(security_flags, 0x6506474)
DEF(targetid, 0x650647d)
DEF(qa_flags, 0x6506498)
DEF(utoken, 0x6506500)
DEF(mov_rax_cr0, -0x9d6ee1)
DEF(mov_cr0_rax, -0x9d6edc)
DEF(mov_rdi_cr2, -0x9d296a)
DEF(lgdt_rdi, -0x990200)
DEF(lidt_lldt, -0x9d6731)
DEF(ltr_ax, -0x9d670f)
DEF(kproc_shutdown, -0x96ad58)
DEF(s_shutdown_final, 0x322db7)
DEF(eventhandler_register, -0x525820)
DEF(strlen_trap, -0x44a918)
DEF(lapic_map, 0x2846fa0)
#include "offset_list.txt"
END_FW()

START_FW(450)
DEF(allproc, 0x27edcb8)
DEF(idt, 0x64cdc80)
DEF(gdt_array, 0x64cee30)
DEF(tss_array, 0x64d0830)
DEF(pcpu_array, 0x64d2280)
DEF(doreti_iret, -0x9cf84c)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x99002a /*-0x990a55*/)
DEF(rdmsr_start, -0x9d0cfa /*-0x9d6d02*/)
//DEF(rdmsr_end, -0x9d6cf9)
DEF(wrmsr_ret, -0x9d20cc)
DEF(dr2gpr_start, -0x9d6d93)
//DEF(dr2gpr_end, -0x9d6d7c)
DEF(gpr2dr_1_start, -0x9d6c7a)
//DEF(gpr2dr_1_end, -0x9d6c55)
DEF(gpr2dr_2_start, -0x9d6b87)
//DEF(gpr2dr_2_end, -0x9d6de9)
DEF(mov_cr3_rax_mov_ds, -0x9d67e9)

//DEF(mov_rdi_cr3, -0x396ebe)
DEF(mov_rax_cr3, -0x392540)

DEF(nop_ret, -0x396de1)
DEF(cpu_switch, -0x9d6f80)
DEF(mprotect_fix_start, -0x90ac61)
DEF(mprotect_fix_end, mprotect_fix_start+6)
DEF(mmap_self_fix_1_start, -0x2cd16d)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, -0x1df11e)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x85A342)
DEF(aslr_fix_end, -0x85A302)

DEF(sigaction_fix_start, -0x6c2959)
DEF(sigaction_fix_end, -0x6c2903)
DEF(sysents, 0x1709c0)
DEF(sysents_ps4, 0x168410)
DEF(sysentvec, 0xd11bb8)
DEF(sysentvec_ps4, 0xd11d30)
DEF(sceSblServiceMailbox, -0x682490)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8a5be0)
DEF(mdbg_call_fix, -0x631e79)
DEF(syscall_before, -0x8022e1)
DEF(syscall_after, -0x8022be)
DEF(malloc, -0xa9940)
DEF(M_something, 0x1346080)
DEF(loadSelfSegment_epilogue, -0x8a546d)
DEF(loadSelfSegment_watchpoint, -0x2cc768)
DEF(loadSelfSegment_watchpoint_lr, -0x8a56c7)
//DEF(decryptSelfBlock_watchpoint, -0x2cc6de)
DEF(decryptSelfBlock_watchpoint_lr, -0x8a532a)
DEF(decryptSelfBlock_epilogue, -0x8a5263)
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8a4bf5)
DEF(decryptMultipleSelfBlocks_epilogue, -0x8a4772)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8a585c)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8a54e1)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8a4fb4)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8a482c)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8a5c5e)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x94a7f0)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x94ada4)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x94ad2e)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x94aaa0)
//DEF(panic, -0x20e40)
DEF(sceSblServiceCryptAsync, -0x8ed930)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x8ed8f2)
DEF(copyin, -0x9908e0)
DEF(copyout, -0x990990)
DEF(crypt_message_resolve, -0x479c30)
DEF(justreturn, -0x9cf990)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xdc16e8)
DEF(pop_all_iret, -0x9cf8ab)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x96db88)
DEF(kernel_pmap_store, 0x3257a78)
DEF(crypt_singleton_array, 0x2e31830)
DEF(security_flags, 0x6506474)
DEF(targetid, 0x650647d)
DEF(qa_flags, 0x6506498)
DEF(utoken, 0x6506500)
DEF(mov_rax_cr0, -0x9d6ee1)
DEF(mov_cr0_rax, -0x9d6edc)
DEF(mov_rdi_cr2, -0x9d296a)
DEF(lgdt_rdi, -0x990200)
DEF(lidt_lldt, -0x9d6731)
DEF(ltr_ax, -0x9d670f)
DEF(kproc_shutdown, -0x966340)
DEF(s_shutdown_final, 0x322a0e)
DEF(eventhandler_register, -0x525710)
DEF(strlen_trap, -0x44a7e8)
DEF(lapic_map, 0x2846fa0)
#include "offset_list.txt"
END_FW()

START_FW(451)
DEF(allproc, 0x27edcb8)
DEF(idt, 0x64cdc80)
DEF(gdt_array, 0x64cee30)
DEF(tss_array, 0x64d0830)
DEF(pcpu_array, 0x64d2280)
DEF(doreti_iret, -0x9cf84c)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x99002a)
DEF(rdmsr_start, -0x9d0cfa)
//DEF(rdmsr_end, -0x9d6cf9)
DEF(wrmsr_ret, -0x9d20cc)
DEF(dr2gpr_start, -0x9d6d93)
//DEF(dr2gpr_end, -0x9d6d7c)
DEF(gpr2dr_1_start, -0x9d6c7a)
//DEF(gpr2dr_1_end, -0x9d6c55)
DEF(gpr2dr_2_start, -0x9d6b87)
//DEF(gpr2dr_2_end, -0x9d6de9)
DEF(mov_cr3_rax_mov_ds, -0x9d67e9)

//DEF(mov_rdi_cr3, -0x396b1e)
DEF(mov_rax_cr3, -0x3921A0)

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0x9d6f80)
DEF(mprotect_fix_start, -0x90ac61)
DEF(mprotect_fix_end, mprotect_fix_start+6)
DEF(mmap_self_fix_1_start, -0x2ccdcd)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, -0x1ded7e)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x85A342)
DEF(aslr_fix_end, -0x85A302)

DEF(sigaction_fix_start, -0x6c2959)
DEF(sigaction_fix_end, -0x6c2903)
DEF(sysents, 0x1709c0)
DEF(sysents_ps4, 0x168410)
DEF(sysentvec, 0xd11bb8)
DEF(sysentvec_ps4, 0xd11d30)
DEF(sceSblServiceMailbox, -0x682490)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8a5be0)
DEF(mdbg_call_fix, -0x631e79)
DEF(syscall_before, -0x8022e1)
DEF(syscall_after, -0x8022be)
DEF(malloc, -0xa9510)
DEF(M_something, 0x1346080)
DEF(loadSelfSegment_epilogue, -0x8a546d)
DEF(loadSelfSegment_watchpoint, -0x2cc3c8)
DEF(loadSelfSegment_watchpoint_lr, -0x8a56c7)
//DEF(decryptSelfBlock_watchpoint, -0x2cc33e)
DEF(decryptSelfBlock_watchpoint_lr, -0x8a532a)
DEF(decryptSelfBlock_epilogue, -0x8a5263)
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8a4bf5)
DEF(decryptMultipleSelfBlocks_epilogue, -0x8a4772)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8a585c)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8a54e1)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8a4fb4)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8a482c)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8a5c5e)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x94a7f0)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x94ada4)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x94ad2e)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x94aaa0)
//DEF(panic, -0x20a10)
DEF(sceSblServiceCryptAsync, -0x8ed930)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x8ed8f2)
DEF(copyin, -0x9908e0)
DEF(copyout, -0x990990)
DEF(crypt_message_resolve, -0x479890)
DEF(justreturn, -0x9cf990)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xdc16e8)
DEF(pop_all_iret, -0x9cf8ab)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x96d488)
DEF(kernel_pmap_store, 0x3257a78)
DEF(crypt_singleton_array, 0x2e31830)
DEF(security_flags, 0x6506474)
DEF(targetid, 0x650647d)
DEF(qa_flags, 0x6506498)
DEF(utoken, 0x6506500)
DEF(mov_rax_cr0, -0x9d6ee1)
DEF(mov_cr0_rax, -0x9d6edc)
DEF(mov_rdi_cr2, -0x9d296a)
DEF(lgdt_rdi, -0x990200)
DEF(lidt_lldt, -0x9d6731)
DEF(ltr_ax, -0x9d670f)
DEF(kproc_shutdown, -0x96b328)
DEF(s_shutdown_final, 0x322c1f)
DEF(eventhandler_register, -0x525370)
DEF(strlen_trap, -0x44a448)
DEF(lapic_map, 0x2846fa0)
#include "offset_list.txt"
END_FW()

START_FW(500)
DEF(allproc, 0x291dd00)
DEF(idt, 0x660dca0)
DEF(gdt_array, 0x660ee50)
DEF(tss_array, 0x6610850)
DEF(pcpu_array, 0x6622680)
DEF(doreti_iret, -0xa04f93)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x9c576a)
DEF(rdmsr_start, -0xa0652a)
DEF(wrmsr_ret, -0xa078fc)
DEF(dr2gpr_start, -0xa0bf13)
DEF(gpr2dr_1_start, -0xa0bdfa)
DEF(gpr2dr_2_start, -0xa0bd07)
DEF(mov_cr3_rax_mov_ds, -0xa0b969)

//DEF(mov_rdi_cr3, -0x3a989e)
DEF(mov_rax_cr3, -0x3A4E30)

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0xa0c100)
DEF(mprotect_fix_start, -0x93efa2)
DEF(mprotect_fix_end, mprotect_fix_start+6)

DEF(mmap_self_fix_1_start, 0x0)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, 0x0)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x88c5aa)
DEF(aslr_fix_end, aslr_fix_start+2)

DEF(sigaction_fix_start, -0x6e7db0)
DEF(sigaction_fix_end, -0x6e7d6e)
DEF(sysents, 0x1b1ef0)
DEF(sysents_ps4, 0x1a9940)
DEF(sysentvec, 0xe00be8)
DEF(sysentvec_ps4, 0xe00d60)
DEF(sceSblServiceMailbox, -0x6a5de0)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8d90d0)
DEF(mdbg_call_fix, -0x650049)
DEF(syscall_before, -0x8357e1)
DEF(syscall_after, -0x8357be)
DEF(malloc, -0xb4df0)
DEF(M_something, 0x14355a0)
DEF(loadSelfSegment_epilogue, -0x8d898d)
DEF(loadSelfSegment_watchpoint, -0x2dd358)
DEF(loadSelfSegment_watchpoint_lr, -0x8d8be7)
DEF(decryptSelfBlock_watchpoint_lr, -0x8d885f)
DEF(decryptSelfBlock_epilogue, -0x8d87a2)
//DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8d8112) //403
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8d8119) //550
DEF(decryptMultipleSelfBlocks_epilogue, -0x8d7ee4)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8d8d76)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8d8a01)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8d8439)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8d7c58)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8d914e)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x97f430)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x97f9df)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x97f969)
//DEF(sceSblPfsSetKeys, -0x97f6e0) // 403
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x9805e0) // 550
DEF(sceSblServiceCryptAsync, -0x921ac0)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x921a82)
DEF(copyin, -0x9c6020)
DEF(copyout, -0x9c60d0)
DEF(crypt_message_resolve, -0x48c080)
DEF(justreturn, -0xa051c0)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xeaf938)
DEF(pop_all_iret, -0xa04ff2)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x9a2d78)
DEF(kernel_pmap_store, 0x3398a88)
DEF(crypt_singleton_array, 0x2f51830)
DEF(security_flags, 0x66466ec)
DEF(targetid, 0x66466f5)
DEF(qa_flags, 0x6646710)
DEF(utoken, 0x6646778)
DEF(mov_rax_cr0, -0xa0c061)
DEF(mov_cr0_rax, -0xa0c05c)
DEF(mov_rdi_cr2, -0xa0828a)
DEF(lgdt_rdi, -0x9c5940)
DEF(lidt_lldt, -0xa0b8b1)
DEF(ltr_ax, -0xa0b88f)
DEF(kproc_shutdown, -0x99ff48)
DEF(s_shutdown_final, 0x364a01)
DEF(eventhandler_register, -0x5375e0)
DEF(strlen_trap, -0x45b98c)
DEF(lapic_map, 0x2976fb0)
#include "offset_list.txt"
END_FW()

START_FW(502)
DEF(allproc, 0x291dd00)
DEF(idt, 0x660dca0)
DEF(gdt_array, 0x660ee50)
DEF(tss_array, 0x6610850)
DEF(pcpu_array, 0x6622680)
DEF(doreti_iret, -0xa04f93)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x9c576a)
DEF(rdmsr_start, -0xa0652a)
DEF(wrmsr_ret, -0xa078fc)
DEF(dr2gpr_start, -0xa0bf13)
DEF(gpr2dr_1_start, -0xa0bdfa)
DEF(gpr2dr_2_start, -0xa0bd07)
DEF(mov_cr3_rax_mov_ds, -0xa0b969)

//DEF(mov_rdi_cr3, -0x3a989e)
DEF(mov_rax_cr3, -0x3A4E30)

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0xa0c100)
DEF(mprotect_fix_start, -0x93efa2)
DEF(mprotect_fix_end, mprotect_fix_start+6)

DEF(mmap_self_fix_1_start, 0x0)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, 0x0)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x88c5aa)
DEF(aslr_fix_end, aslr_fix_start+2)

DEF(sigaction_fix_start, -0x6e7db0)
DEF(sigaction_fix_end, -0x6e7d6e)
DEF(sysents, 0x1b1ef0)
DEF(sysents_ps4, 0x1a9940)
DEF(sysentvec, 0xe00be8)
DEF(sysentvec_ps4, 0xe00d60)
DEF(sceSblServiceMailbox, -0x6a5de0)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8d90d0)
DEF(mdbg_call_fix, -0x650049)
DEF(syscall_before, -0x8357e1)
DEF(syscall_after, -0x8357be)
DEF(malloc, -0xb4df0)
DEF(M_something, 0x14355a0)
DEF(loadSelfSegment_epilogue, -0x8d898d)
DEF(loadSelfSegment_watchpoint, -0x2dd358)
DEF(loadSelfSegment_watchpoint_lr, -0x8d8be7)
DEF(decryptSelfBlock_watchpoint_lr, -0x8d885f)
DEF(decryptSelfBlock_epilogue, -0x8d87a2)
//DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8d8112) //403
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8d8119) //550
DEF(decryptMultipleSelfBlocks_epilogue, -0x8d7ee4)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8d8d76)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8d8a01)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8d8439)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8d7c58)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8d914e)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x97f430)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x97f9df)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x97f969)
//DEF(sceSblPfsSetKeys, -0x97f6e0) // 403
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x9805e0) // 550
DEF(sceSblServiceCryptAsync, -0x921ac0)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x921a82)
DEF(copyin, -0x9c6020)
DEF(copyout, -0x9c60d0)
DEF(crypt_message_resolve, -0x48c080)
DEF(justreturn, -0xa051c0)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xeaf938)
DEF(pop_all_iret, -0xa04ff2)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x9a33c8)
DEF(kernel_pmap_store, 0x3398a88)
DEF(crypt_singleton_array, 0x2f51830)
DEF(security_flags, 0x66466ec)
DEF(targetid, 0x66466f5)
DEF(qa_flags, 0x6646710)
DEF(utoken, 0x6646778)
DEF(mov_rax_cr0, -0xa0c061)
DEF(mov_cr0_rax, -0xa0c05c)
DEF(mov_rdi_cr2, -0xa0828a)
DEF(lgdt_rdi, -0x9c5940)
DEF(lidt_lldt, -0xa0b8b1)
DEF(ltr_ax, -0xa0b88f)
DEF(kproc_shutdown, -0x99ff48)
DEF(s_shutdown_final, 0x364a01)
DEF(eventhandler_register, -0x5375e0)
DEF(strlen_trap, -0x45b98c)
DEF(lapic_map, 0x2976fb0)
#include "offset_list.txt"
END_FW()

START_FW(510)
DEF(allproc, 0x291dd00)
DEF(idt, 0x660dca0)
DEF(gdt_array, 0x660ee50)
DEF(tss_array, 0x6610850)
DEF(pcpu_array, 0x6622680)
DEF(doreti_iret, -0xa04f93)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x9c576a)
DEF(rdmsr_start, -0xa0652a)
DEF(wrmsr_ret, -0xa078fc)
DEF(dr2gpr_start, -0xa0bf13)
DEF(gpr2dr_1_start, -0xa0bdfa)
DEF(gpr2dr_2_start, -0xa0bd07)
DEF(mov_cr3_rax_mov_ds, -0xa0b969)

//DEF(mov_rdi_cr3, -0x3a96ce)
DEF(mov_rax_cr3, -0x3A4C60)

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0xa0c100)
DEF(mprotect_fix_start, -0x93efa2)
DEF(mprotect_fix_end, mprotect_fix_start+6)

DEF(mmap_self_fix_1_start, 0x0)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, 0x0)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x88c5aa)
DEF(aslr_fix_end, aslr_fix_start+2)

DEF(sigaction_fix_start, -0x6e7be0)
DEF(sigaction_fix_end, -0x6e7b9e)
DEF(sysents, 0x1b2040)
DEF(sysents_ps4, 0x1a9a90)
DEF(sysentvec, 0xe00be8)
DEF(sysentvec_ps4, 0xe00d60)
DEF(sceSblServiceMailbox, -0x6a5c10)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8d90d0)
DEF(mdbg_call_fix, -0x64fe79)
DEF(syscall_before, -0x8357e1)
DEF(syscall_after, -0x8357be)
DEF(malloc, -0xb4ac0)
DEF(M_something, 0x14355a0)
DEF(loadSelfSegment_epilogue, -0x8d898d)
DEF(loadSelfSegment_watchpoint, -0x2dd108)
DEF(loadSelfSegment_watchpoint_lr, -0x8d8be7)
DEF(decryptSelfBlock_watchpoint_lr, -0x8d885f)
DEF(decryptSelfBlock_epilogue, -0x8d87a2)
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8d8119)
DEF(decryptMultipleSelfBlocks_epilogue, -0x8d7ee4)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8d8d76)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8d8A01)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8d8439)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8d7C58)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8d914E)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x97F430)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x97F9DF)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x97F969)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x9805E0)
DEF(sceSblServiceCryptAsync, -0x921AC0)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x921A82)
DEF(copyin, -0x9c6020)
DEF(copyout, -0x9c60D0)
DEF(crypt_message_resolve, -0x48BEB0)
DEF(justreturn, -0xa051c0)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xeb0938)
DEF(pop_all_iret, -0xa04ff2)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x9a3e70)
DEF(kernel_pmap_store, 0x3398a88)
DEF(crypt_singleton_array, 0x2f51830)
DEF(security_flags, 0x66466EC)
DEF(targetid, 0x66466F5)
DEF(qa_flags, 0x6646710)
DEF(utoken, 0x6646778)
DEF(mov_rax_cr0, -0xa0c061)
DEF(mov_cr0_rax, -0xa0c05c)
DEF(mov_rdi_cr2, -0xa0828a)
DEF(lgdt_rdi, -0x9c5940)
DEF(lidt_lldt, -0xa0b8b1)
DEF(ltr_ax, -0xa0b88f)
DEF(kproc_shutdown, -0x9a0c60)
DEF(s_shutdown_final, 0x3648c2)
DEF(eventhandler_register, -0x537410)
DEF(strlen_trap, -0x45B7BC)
DEF(lapic_map, 0x2976fb0)
#include "offset_list.txt"
END_FW()

START_FW(550)
DEF(allproc, 0x291dd00)
DEF(idt, 0x660dca0)
DEF(gdt_array, 0x660ee50)
DEF(tss_array, 0x6610850)
DEF(pcpu_array, 0x6622680)
DEF(doreti_iret, -0xa04fd3)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x9c57aa)
DEF(rdmsr_start, -0xa0656a)
DEF(wrmsr_ret, -0xa0793c)
DEF(dr2gpr_start, -0xa0bf53)
DEF(gpr2dr_1_start, -0xa0be3a)
DEF(gpr2dr_2_start, -0xa0bd47)
DEF(mov_cr3_rax_mov_ds, -0xa0b9A9)

//DEF(mov_rdi_cr3, -0x3a88de)
DEF(mov_rax_cr3, -0x3A3E70)

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0xa0c140)
DEF(mprotect_fix_start, -0x93EFE2)
DEF(mprotect_fix_end, mprotect_fix_start+6)

DEF(mmap_self_fix_1_start, 0x0)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, 0x0)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x88C4FA)
DEF(aslr_fix_end, aslr_fix_start+2)

DEF(sigaction_fix_start, -0x6e7b30)
DEF(sigaction_fix_end, -0x6e7aee)
DEF(sysents, 0x1b2210)
DEF(sysents_ps4, 0x1a9c60)
DEF(sysentvec, 0xe00be8)
DEF(sysentvec_ps4, 0xe00d60)
DEF(sceSblServiceMailbox, -0x6a5b60)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8d9110)
DEF(mdbg_call_fix, -0x64fb79)
DEF(syscall_before, -0x835731)
DEF(syscall_after, -0x83570e)
DEF(malloc, -0xb3cd0)
DEF(M_something, 0x14355a0)
DEF(loadSelfSegment_epilogue, -0x8d89CD)
DEF(loadSelfSegment_watchpoint, -0x2dC318)
DEF(loadSelfSegment_watchpoint_lr, -0x8d8C27)
DEF(decryptSelfBlock_watchpoint_lr, -0x8d889F)
DEF(decryptSelfBlock_epilogue, -0x8d87E2)
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8d8159)
DEF(decryptMultipleSelfBlocks_epilogue, -0x8d7F24)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8d8DB6)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8d8A41)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8d8479)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8d7C98)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8d918E)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x97F470)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x97FA1F)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x97F9A9)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, -0x32AEBB)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, -0x32AC0A)
DEF(sceSblPfsSetKeys, -0x980620)
DEF(sceSblServiceCryptAsync, -0x921B00)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x921AC2)
DEF(copyin, -0x9c6060)
DEF(copyout, -0x9c6110)
DEF(crypt_message_resolve, -0x48B0C0)
DEF(justreturn, -0xa05200)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xeaf938)
DEF(pop_all_iret, -0xa05032)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x99fc70)
DEF(kernel_pmap_store, 0x3394a88)
DEF(crypt_singleton_array, 0x2f4d830)
DEF(security_flags, 0x66466EC)
DEF(targetid, 0x66466F5)
DEF(qa_flags, 0x6646710)
DEF(utoken, 0x6646778)
DEF(mov_rax_cr0, -0xa0c0a1)
DEF(mov_cr0_rax, -0xa0c09c)
DEF(mov_rdi_cr2, -0xa082ca)
DEF(lgdt_rdi, -0x9c5980)
DEF(lidt_lldt, -0xa0b8f1)
DEF(ltr_ax, -0xa0b8cf)
DEF(kproc_shutdown, -0x9a0b38)
DEF(s_shutdown_final, 0x365116)
DEF(eventhandler_register, -0x536620)
DEF(strlen_trap, -0x45a9cc)
DEF(lapic_map, 0x2976fb0)
#include "offset_list.txt"
END_FW()

START_FW(600)
DEF(allproc, 0x2869d20)
DEF(idt, 0x655dde0)
DEF(gdt_array, 0x655f000)
DEF(tss_array, 0x6560a00)
DEF(pcpu_array, 0x6572880)
DEF(doreti_iret, -0xa1b813)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x9dbfea)
DEF(rdmsr_start, -0xa1cdaa)
DEF(wrmsr_ret, -0xa1e17c)
DEF(dr2gpr_start, -0xa22793)
DEF(gpr2dr_1_start, -0xa2267a)
DEF(gpr2dr_2_start, -0xa22587)
DEF(mov_cr3_rax_mov_ds, -0xa221e9)

//DEF(mov_rdi_cr3, -0x3aa3be)
DEF(mov_rax_cr3, -0x3A590E) //data 0x8BA6F2

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0xa22980)
DEF(mprotect_fix_start, -0x9546d2)
DEF(mprotect_fix_end, mprotect_fix_start+6)

DEF(mmap_self_fix_1_start, 0x0)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, 0x0)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x89F3ED)
DEF(aslr_fix_end, aslr_fix_start+2)

DEF(sigaction_fix_start, -0x6f6b92)
DEF(sigaction_fix_end, -0x6f6b68)
DEF(sysents, 0x1b49a0)
DEF(sysents_ps4, 0x1ac3f0)
DEF(sysentvec, 0xe210a8)
DEF(sysentvec_ps4, 0xe21220)
DEF(sceSblServiceMailbox, -0x6b28c0)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8ed120)
DEF(mdbg_call_fix, -0x65c2a9)
DEF(syscall_before, -0x844a71)
DEF(syscall_after, -0x844a4e)
DEF(malloc, -0xaa4c0)
DEF(M_something, 0x1456690)
DEF(loadSelfSegment_epilogue, -0x8ec9ed)
DEF(loadSelfSegment_watchpoint, -0x2da988)
DEF(loadSelfSegment_watchpoint_lr, -0x8ecc47)
DEF(decryptSelfBlock_watchpoint_lr, -0x8ec8bf)
DEF(decryptSelfBlock_epilogue, -0x8ec802)
//DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8ec172) //403
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8ec179) //550
DEF(decryptMultipleSelfBlocks_epilogue, -0x8ebf44)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8ecdd9)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8eca61)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8ec499)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8ebca8)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8ed19e)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x995381)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x995931)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x9958bb)
//DEF(sceSblPfsSetKeys, -0x995630) //403
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x996400) //550
DEF(sceSblServiceCryptAsync, -0x936080)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x936042)
DEF(copyin, -0x9dc8a0)
DEF(copyout, -0x9dc950)
DEF(crypt_message_resolve, -0x490200)
DEF(justreturn, -0xa1ba40)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xed2048)
DEF(pop_all_iret, -0xa1b872)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x9b99e0)
DEF(kernel_pmap_store, 0x32e4358)
DEF(crypt_singleton_array, 0x2e9d830)
DEF(security_flags, 0x65968ec)
DEF(targetid, 0x65968f5)
DEF(qa_flags, 0x6596910)
DEF(utoken, 0x6596978)
DEF(mov_rax_cr0, -0xa228e1)
DEF(mov_cr0_rax, -0xa228dc)
DEF(mov_rdi_cr2, -0x2414f6)
DEF(lgdt_rdi, -0x9DC1C0)
DEF(lidt_lldt, -0xa22131)
DEF(ltr_ax, -0xa2210f)
DEF(kproc_shutdown, -0x9b50a8)
DEF(s_shutdown_final, 0x367fd8)
DEF(eventhandler_register, -0x53DE00)
DEF(strlen_trap, -0x45de23)
DEF(lapic_map, 0x28C2FF0)
#include "offset_list.txt"
END_FW()

START_FW(602)
DEF(allproc, 0x2869d20)
DEF(idt, 0x655dde0)
DEF(gdt_array, 0x655f000)
DEF(tss_array, 0x6560a00)
DEF(pcpu_array, 0x6572880)
DEF(doreti_iret, -0xa1b813)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x9dbfea)
DEF(rdmsr_start, -0xa1cdaa)
DEF(wrmsr_ret, -0xa1e17c)
DEF(dr2gpr_start, -0xa22793)
DEF(gpr2dr_1_start, -0xa2267a)
DEF(gpr2dr_2_start, -0xa22587)
DEF(mov_cr3_rax_mov_ds, -0xa221e9)

//DEF(mov_rdi_cr3, -0x3aa3de)
DEF(mov_rax_cr3, -0x3A592E) //data 0x8BA6D2

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0xa22980)
DEF(mprotect_fix_start, -0x9546d2)
DEF(mprotect_fix_end, mprotect_fix_start+6)

DEF(mmap_self_fix_1_start, 0x0)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, 0x0)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x89F3ED)
DEF(aslr_fix_end, aslr_fix_start+2)

DEF(sigaction_fix_start, -0x6f6b92)
DEF(sigaction_fix_end, -0x6f6b68)
DEF(sysents, 0x1b49f0)
DEF(sysents_ps4, 0x1ac440)
DEF(sysentvec, 0xe210a8)
DEF(sysentvec_ps4, 0xe21220)
DEF(sceSblServiceMailbox, -0x6b28c0)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8ed120)
DEF(mdbg_call_fix, -0x65c2c9)
DEF(syscall_before, -0x844a71)
DEF(syscall_after, -0x844a4e)
DEF(malloc, -0xaa4e0)
DEF(M_something, 0x1456690)
DEF(loadSelfSegment_epilogue, -0x8ec9ed)
DEF(loadSelfSegment_watchpoint, -0x2da9a8)
DEF(loadSelfSegment_watchpoint_lr, -0x8ecc47)
DEF(decryptSelfBlock_watchpoint_lr, -0x8ec8bf)
DEF(decryptSelfBlock_epilogue, -0x8ec802)
//DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8ec172) //403
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8ec179) //550
DEF(decryptMultipleSelfBlocks_epilogue, -0x8ebf44)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8ecdd9)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8eca61)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8ec499)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8ebca8)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8ed19e)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x995381)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x995931)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x9958bb)
//DEF(sceSblPfsSetKeys, -0x995630) //403
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x996400) //550
DEF(sceSblServiceCryptAsync, -0x936080)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x936042)
DEF(copyin, -0x9dc8a0)
DEF(copyout, -0x9dc950)
DEF(crypt_message_resolve, -0x490220)
DEF(justreturn, -0xa1ba40)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xed2048)
DEF(pop_all_iret, -0xa1b872)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x9b9e20)
DEF(kernel_pmap_store, 0x32e4358)
DEF(crypt_singleton_array, 0x2e9d830)
DEF(security_flags, 0x65968ec)
DEF(targetid, 0x65968f5)
DEF(qa_flags, 0x6596910)
DEF(utoken, 0x6596978)
DEF(mov_rax_cr0, -0xa228e1)
DEF(mov_cr0_rax, -0xa228dc)
DEF(mov_rdi_cr2, -0x2414f6)
DEF(lgdt_rdi, -0x9DC1C0)
DEF(lidt_lldt, -0xa22131)
DEF(ltr_ax, -0xa2210f)
DEF(kproc_shutdown, -0x9b4388)
DEF(s_shutdown_final, 0x367f81)
DEF(eventhandler_register, -0x53de20)
DEF(strlen_trap, -0x45de43)
DEF(lapic_map, 0x28C2FF0)
#include "offset_list.txt"
END_FW()

START_FW(650)
DEF(allproc, 0x2869d20)
DEF(idt, 0x655dde0)
DEF(gdt_array, 0x655f000)
DEF(tss_array, 0x6560a00)
DEF(pcpu_array, 0x6572880)
DEF(doreti_iret, -0xa1b813)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x9dbfea)
DEF(rdmsr_start, -0xa1cdaa)
DEF(wrmsr_ret, -0xa1e17c)
DEF(dr2gpr_start, -0xa22793)
DEF(gpr2dr_1_start, -0xa2267a)
DEF(gpr2dr_2_start, -0xa22587)
DEF(mov_cr3_rax_mov_ds, -0xa221e9)

//DEF(mov_rdi_cr3, -0x3aa14e)
DEF(mov_rax_cr3, -0x3A569E) //data 0x8BA962

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0xa22980)
DEF(mprotect_fix_start, -0x9546e2)
DEF(mprotect_fix_end, mprotect_fix_start+6)

DEF(mmap_self_fix_1_start, 0x0)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, 0x0)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x89F3CD)
DEF(aslr_fix_end, aslr_fix_start+2)

DEF(sigaction_fix_start, -0x6f6b12)
DEF(sigaction_fix_end, -0x6f6ae8)
DEF(sysents, 0x1b49f0)
DEF(sysents_ps4, 0x1ac440)
DEF(sysentvec, 0xe210a8)
DEF(sysentvec_ps4, 0xe21220)
DEF(sceSblServiceMailbox, -0x6b2790)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8ed100)
DEF(mdbg_call_fix, -0x65c199)
DEF(syscall_before, -0x844a51)
DEF(syscall_after, -0x844a2e)
DEF(malloc, -0xa9d40)
DEF(M_something, 0x1456690)
DEF(loadSelfSegment_epilogue, -0x8ec9cd)
DEF(loadSelfSegment_watchpoint, -0x2da218)
DEF(loadSelfSegment_watchpoint_lr, -0x8ecc27)
DEF(decryptSelfBlock_watchpoint_lr, -0x8ec89f)
DEF(decryptSelfBlock_epilogue, -0x8ec7e2)
//DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8ec152) //403
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8ec159) //550
DEF(decryptMultipleSelfBlocks_epilogue, -0x8ebf24)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8ecdb9)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8eca41)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8ec479)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8ebc88)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8ed17e)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x995381)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x995931)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x9958bb)
//DEF(sceSblPfsSetKeys, -0x995630) //403
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x996400) //550
DEF(sceSblServiceCryptAsync, -0x936090)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x936052)
DEF(copyin, -0x9dc8a0)
DEF(copyout, -0x9dc950)
DEF(crypt_message_resolve, -0x490060)
DEF(justreturn, -0xa1ba40)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xed2048)
DEF(pop_all_iret, -0xa1b872)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x9ba368)
DEF(kernel_pmap_store, 0x32e4358)
DEF(crypt_singleton_array, 0x2e9d830)
DEF(security_flags, 0x65968ec)
DEF(targetid, 0x65968f5)
DEF(qa_flags, 0x6596910)
DEF(utoken, 0x6596978)
DEF(mov_rax_cr0, -0xa228e1)
DEF(mov_cr0_rax, -0xa228dc)
DEF(mov_rdi_cr2, -0x2414f6)
DEF(lgdt_rdi, -0x9DC1C0)
DEF(lidt_lldt, -0xa22131)
DEF(ltr_ax, -0xa2210f)
DEF(kproc_shutdown, -0x9af530)
DEF(s_shutdown_final, 0x367fad)
DEF(eventhandler_register, -0x53dc60)
DEF(strlen_trap, -0x45dc83)
DEF(lapic_map, 0x28C2FF0)
#include "offset_list.txt"
END_FW()

START_FW(700)
DEF(allproc, 0x2859D50)
DEF(idt, 0x2E7FDF0)
DEF(gdt_array, 0x2E810B0)
DEF(tss_array, 0x2E82AB0)
DEF(pcpu_array, 0x2E94A00)
DEF(doreti_iret, -0xA0BA33)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x9CC1A6)
DEF(rdmsr_start, -0xA0D16A)
DEF(wrmsr_ret, -0xA0E53C)
DEF(dr2gpr_start, -0xA12B53)
DEF(gpr2dr_1_start, -0xA12A3A)
DEF(gpr2dr_2_start, -0xA12947)
DEF(mov_cr3_rax_mov_ds, -0xa125a9)

//DEF(mov_rdi_cr3, -0x3B320E)
DEF(mov_rax_cr3, -0x3AE07E) //data 0x8A1F82

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0xA12D40)
DEF(mprotect_fix_start, -0x944F84)
DEF(mprotect_fix_end, mprotect_fix_start+6)

DEF(mmap_self_fix_1_start, 0x0)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, 0x0)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x890F17)
DEF(aslr_fix_end, aslr_fix_start+2)

DEF(sigaction_fix_start, -0x6F02DD)
DEF(sigaction_fix_end, -0x6F02C2)
DEF(sysents, 0x1B7030)
DEF(sysents_ps4, 0x1AEA80)
DEF(sysentvec, 0xE21AB8)
DEF(sysentvec_ps4, 0xE21C30)
DEF(sceSblServiceMailbox, -0x6AD700)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8DF590)
DEF(mdbg_call_fix, -0x6595A9)
DEF(syscall_before, -0x8375CF)
DEF(syscall_after, -0x8375AC)
DEF(malloc, -0xB6C60)
DEF(M_something, 0x1457590)
DEF(loadSelfSegment_epilogue, -0x8DEE99)
DEF(loadSelfSegment_watchpoint, -0x2E30C8)
DEF(loadSelfSegment_watchpoint_lr, -0x8DF0E7)
DEF(decryptSelfBlock_watchpoint_lr, -0x8DED6F)
DEF(decryptSelfBlock_epilogue, -0x8DECB2)
//DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8DE632) //403
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8DE639) //550
DEF(decryptMultipleSelfBlocks_epilogue, -0x8DE404)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8DF276)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8DEF09)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8DE956)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8DE171)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8DF608)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x9852FD)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x98589B)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x985828)
//DEF(sceSblPfsSetKeys, -0x9855A0) //403
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x986420) //550
DEF(sceSblServiceCryptAsync, -0x9271E0)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x9271A2)
DEF(copyin, -0x9CCA70)
DEF(copyout, -0x9CCB20)
DEF(crypt_message_resolve, -0x491BB0)
DEF(justreturn, -0xA0BC60)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xE7DD98)
DEF(pop_all_iret, -0xA0BA92)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x9AAFC8)
DEF(kernel_pmap_store, 0x2E2C848)
DEF(crypt_singleton_array, 0x2D71830)
DEF(security_flags, 0xAC8064)
DEF(targetid, 0xAC806D)
DEF(qa_flags, 0xAC8088)
DEF(utoken, 0xAC80F0)
DEF(mov_rax_cr0, -0xa12ca1)
DEF(mov_cr0_rax, -0xa12c9c)
DEF(mov_rdi_cr2, -0xa2296a)
DEF(lgdt_rdi, -0x9cc380)
DEF(lidt_lldt, -0xa124f1)
DEF(ltr_ax, -0xa124cf)
DEF(kproc_shutdown, -0x99ba88)
DEF(s_shutdown_final, 0x417acb)
DEF(eventhandler_register, -0x53d740)
DEF(strlen_trap, -0x4607e8)
DEF(lapic_map, 0x28B3830)
#include "offset_list.txt"
END_FW()

START_FW(701)
DEF(allproc, 0x2859D50)
DEF(idt, 0x2E7FDF0)
DEF(gdt_array, 0x2E810B0)
DEF(tss_array, 0x2E82AB0)
DEF(pcpu_array, 0x2E94A00)
DEF(doreti_iret, -0xA0BA33)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x9CC1A6)
DEF(rdmsr_start, -0xA0D16A)
DEF(wrmsr_ret, -0xA0E53C)
DEF(dr2gpr_start, -0xA12B53)
DEF(gpr2dr_1_start, -0xA12A3A)
DEF(gpr2dr_2_start, -0xA12947)
DEF(mov_cr3_rax_mov_ds, -0xa125a9)

//DEF(mov_rdi_cr3, -0x3B320E)
DEF(mov_rax_cr3, -0x3AE07E) //data 0x8A1F82

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0xA12D40)
DEF(mprotect_fix_start, -0x944F84)
DEF(mprotect_fix_end, mprotect_fix_start+6)

DEF(mmap_self_fix_1_start, 0x0)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, 0x0)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x890F17)
DEF(aslr_fix_end, aslr_fix_start+2)

DEF(sigaction_fix_start, -0x6F02DD)
DEF(sigaction_fix_end, -0x6F02C2)
DEF(sysents, 0x1B7030)
DEF(sysents_ps4, 0x1AEA80)
DEF(sysentvec, 0xE21AB8)
DEF(sysentvec_ps4, 0xE21C30)
DEF(sceSblServiceMailbox, -0x6AD700)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8DF590)
DEF(mdbg_call_fix, -0x6595A9)
DEF(syscall_before, -0x8375CF)
DEF(syscall_after, -0x8375AC)
DEF(malloc, -0xB6C60)
DEF(M_something, 0x1457590)
DEF(loadSelfSegment_epilogue, -0x8DEE99)
DEF(loadSelfSegment_watchpoint, -0x2E30C8)
DEF(loadSelfSegment_watchpoint_lr, -0x8DF0E7)
DEF(decryptSelfBlock_watchpoint_lr, -0x8DED6F)
DEF(decryptSelfBlock_epilogue, -0x8DECB2)
//DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8DE632) //403
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8DE639) //550
DEF(decryptMultipleSelfBlocks_epilogue, -0x8DE404)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8DF276)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8DEF09)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8DE956)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8DE171)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8DF608)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x9852FD)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x98589B)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x985828)
//DEF(sceSblPfsSetKeys, -0x9855A0) //403
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x986420) //550
DEF(sceSblServiceCryptAsync, -0x9271E0)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x9271A2)
DEF(copyin, -0x9CCA70)
DEF(copyout, -0x9CCB20)
DEF(crypt_message_resolve, -0x491BB0)
DEF(justreturn, -0xA0BC60)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xE7DD98)
DEF(pop_all_iret, -0xA0BA92)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x9A9310)
DEF(kernel_pmap_store, 0x2E2C848)
DEF(crypt_singleton_array, 0x2D71830)
DEF(security_flags, 0xAC8064)
DEF(targetid, 0xAC806D)
DEF(qa_flags, 0xAC8088)
DEF(utoken, 0xAC80F0)
DEF(mov_rax_cr0, -0xa12ca1)
DEF(mov_cr0_rax, -0xa12c9c)
DEF(mov_rdi_cr2, -0xa2296a)
DEF(lgdt_rdi, -0x9cc380)
DEF(lidt_lldt, -0xa124f1)
DEF(ltr_ax, -0xa124cf)
DEF(kproc_shutdown, -0x99f1e0)
DEF(s_shutdown_final, 0x4177d5)
DEF(eventhandler_register, -0x53d740)
DEF(strlen_trap, -0x4607e8)
DEF(lapic_map, 0x28B3830)
#include "offset_list.txt"
END_FW()

START_FW(720)
DEF(allproc, 0x2859D50)
DEF(idt, 0x2E7FDF0)
DEF(gdt_array, 0x2E810D0)
DEF(tss_array, 0x2E82AD0)
DEF(pcpu_array, 0x2E94A00)
DEF(doreti_iret, -0xA0B7F3)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x9CBF66)
DEF(rdmsr_start, -0xA0CF2A)
DEF(wrmsr_ret, -0xA0E2FC)
DEF(dr2gpr_start, -0xA12913)
DEF(gpr2dr_1_start, -0xA127FA)
DEF(gpr2dr_2_start, -0xA12707)
DEF(mov_cr3_rax_mov_ds, -0xa12369)

//DEF(mov_rdi_cr3, -0x3B2F0E)
DEF(mov_rax_cr3, -0x3ADD7E) //data 0x8A2282

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0xA12B00)
DEF(mprotect_fix_start, -0x944D24)
DEF(mprotect_fix_end, mprotect_fix_start+6)

DEF(mmap_self_fix_1_start, 0x0)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, 0x0)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x890C10)
DEF(aslr_fix_end, aslr_fix_start+2)

DEF(sigaction_fix_start, -0x6EFFDD)
DEF(sigaction_fix_end, -0x6EFFC2)
DEF(sysents, 0x1B71A0)
DEF(sysents_ps4, 0x1AEBF0)
DEF(sysentvec, 0xE21B78)
DEF(sysentvec_ps4, 0xE21CF0)
DEF(sceSblServiceMailbox, -0x6AD400)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8DF330)
DEF(mdbg_call_fix, -0x6592A9)
DEF(syscall_before, -0x8372CF)
DEF(syscall_after, -0x8372AC)
DEF(malloc, -0xB5C60)
DEF(M_something, 0x1457650)
DEF(loadSelfSegment_epilogue, -0x8DEC39)
DEF(loadSelfSegment_watchpoint, -0x2E2DC8)
DEF(loadSelfSegment_watchpoint_lr, -0x8DEE87)
DEF(decryptSelfBlock_watchpoint_lr, -0x8DEB0F)
DEF(decryptSelfBlock_epilogue, -0x8DEA52)
//DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8DE3D2) //403
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8DE3D9) //550
DEF(decryptMultipleSelfBlocks_epilogue, -0x8DE1A4)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8DF016)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8DECA9)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8DE6F6)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8DDF11)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8DF3A8)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x98509D)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x98563B)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x9855C8)
//DEF(sceSblPfsSetKeys, -0x985340) //403
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x9861C0) //550
DEF(sceSblServiceCryptAsync, -0x926F80)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x926F42)
DEF(copyin, -0x9CC830)
DEF(copyout, -0x9CC8E0)
DEF(crypt_message_resolve, -0x4918B0)
DEF(justreturn, -0xA0BA20)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xE7DE58)
DEF(pop_all_iret, -0xA0B852)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x9AAA88)
DEF(kernel_pmap_store, 0x2E2C848)
DEF(crypt_singleton_array, 0x2D71830)
DEF(security_flags, 0xAC8064)
DEF(targetid, 0xAC806D)
DEF(qa_flags, 0xAC8088)
DEF(utoken, 0xAC80F0)
DEF(mov_rax_cr0, -0xa12a61)
DEF(mov_cr0_rax, -0xa12a5c)
DEF(mov_rdi_cr2, -0xa0ec8a)
DEF(lgdt_rdi, -0x9cc140)
DEF(lidt_lldt, -0xa122b1)
DEF(ltr_ax, -0xa1228f)
DEF(kproc_shutdown, -0x9a7498)
DEF(s_shutdown_final, 0x417705)
DEF(eventhandler_register, -0x53d440)
DEF(strlen_trap, -0x4604e8)
DEF(lapic_map, 0x28B3830)
#include "offset_list.txt"
END_FW()

START_FW(740)
DEF(allproc, 0x2859D50)
DEF(idt, 0x2E7FDF0)
DEF(gdt_array, 0x2E810D0)
DEF(tss_array, 0x2E82AD0)
DEF(pcpu_array, 0x2E94A00)
DEF(doreti_iret, -0xA0B7F3)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x9CBF66)
DEF(rdmsr_start, -0xA0CF2A)
DEF(wrmsr_ret, -0xA0E2FC)
DEF(dr2gpr_start, -0xA12913)
DEF(gpr2dr_1_start, -0xA127FA)
DEF(gpr2dr_2_start, -0xA12707)
DEF(mov_cr3_rax_mov_ds, -0xa12369)

//DEF(mov_rdi_cr3, -0x3B2F0E)
DEF(mov_rax_cr3, -0x3ADD7E) //data 0x8A2282

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0xA12B00)
DEF(mprotect_fix_start, -0x944D24)
DEF(mprotect_fix_end, mprotect_fix_start+6)

DEF(mmap_self_fix_1_start, 0x0)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, 0x0)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x890C10)
DEF(aslr_fix_end, aslr_fix_start+2)

DEF(sigaction_fix_start, -0x6EFFDD)
DEF(sigaction_fix_end, -0x6EFFC2)
DEF(sysents, 0x1B71A0)
DEF(sysents_ps4, 0x1AEBF0)
DEF(sysentvec, 0xE21B78)
DEF(sysentvec_ps4, 0xE21CF0)
DEF(sceSblServiceMailbox, -0x6AD400)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8DF330)
DEF(mdbg_call_fix, -0x6592A9)
DEF(syscall_before, -0x8372CF)
DEF(syscall_after, -0x8372AC)
DEF(malloc, -0xB5C60)
DEF(M_something, 0x1457650)
DEF(loadSelfSegment_epilogue, -0x8DEC39)
DEF(loadSelfSegment_watchpoint, -0x2E2DC8)
DEF(loadSelfSegment_watchpoint_lr, -0x8DEE87)
DEF(decryptSelfBlock_watchpoint_lr, -0x8DEB0F)
DEF(decryptSelfBlock_epilogue, -0x8DEA52)
//DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8DE3D2) //403
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8DE3D9) //550
DEF(decryptMultipleSelfBlocks_epilogue, -0x8DE1A4)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8DF016)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8DECA9)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8DE6F6)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8DDF11)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8DF3A8)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x98509D)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x98563B)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x9855C8)
//DEF(sceSblPfsSetKeys, -0x985340) //403
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x9861C0) //550
DEF(sceSblServiceCryptAsync, -0x926F80)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x926F42)
DEF(copyin, -0x9CC830)
DEF(copyout, -0x9CC8E0)
DEF(crypt_message_resolve, -0x4918B0)
DEF(justreturn, -0xA0BA20)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xE7DE58)
DEF(pop_all_iret, -0xA0B852)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x9A0330)
DEF(kernel_pmap_store, 0x2E2C848)
DEF(crypt_singleton_array, 0x2D71830)
DEF(security_flags, 0xAC8064)
DEF(targetid, 0xAC806D)
DEF(qa_flags, 0xAC8088)
DEF(utoken, 0xAC80F0)
DEF(mov_rax_cr0, -0xa12a61)
DEF(mov_cr0_rax, -0xa12a5c)
DEF(mov_rdi_cr2, -0xa0ec8a)
DEF(lgdt_rdi, -0x9cc140)
DEF(lidt_lldt, -0xa122b1)
DEF(ltr_ax, -0xa1228f)
DEF(kproc_shutdown, -0x9a7318)
DEF(s_shutdown_final, 0x417cf6)
DEF(eventhandler_register, -0x53d440)
DEF(strlen_trap, -0x4604e8)
DEF(lapic_map, 0x28B3830)
#include "offset_list.txt"
END_FW()

START_FW(760)
DEF(allproc, 0x2859D50)
DEF(idt, 0x2E7FDF0)
DEF(gdt_array, 0x2E810D0)
DEF(tss_array, 0x2E82AD0)
DEF(pcpu_array, 0x2E94A00)
DEF(doreti_iret, -0xA0B7F3)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x9CBF66)
DEF(rdmsr_start, -0xA0CF2A)
DEF(wrmsr_ret, -0xA0E2FC)
DEF(dr2gpr_start, -0xA12913)
DEF(gpr2dr_1_start, -0xA127FA)
DEF(gpr2dr_2_start, -0xA12707)
DEF(mov_cr3_rax_mov_ds, -0xa12369)

//DEF(mov_rdi_cr3, -0x3B2DCE)
DEF(mov_rax_cr3, -0x3ADC3E) //data 0x8A23C2

DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0xA12B00)
DEF(mprotect_fix_start, -0x944D14)
DEF(mprotect_fix_end, mprotect_fix_start+6)

DEF(mmap_self_fix_1_start, 0x0)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, 0x0)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x890C00)
DEF(aslr_fix_end, aslr_fix_start+2)

DEF(sigaction_fix_start, -0x6EFFCD)
DEF(sigaction_fix_end, -0x6EFFB2)
DEF(sysents, 0x1B7260)
DEF(sysents_ps4, 0x1AECB0)
DEF(sysentvec, 0xE21B78)
DEF(sysentvec_ps4, 0xE21CF0)
DEF(sceSblServiceMailbox, -0x6AD3F0)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8DF320)
DEF(mdbg_call_fix, -0x659169)
DEF(syscall_before, -0x8372BF)
DEF(syscall_after, -0x83729C)
DEF(malloc, -0xB5650)
DEF(M_something, 0x1457650)
DEF(loadSelfSegment_epilogue, -0x8DEC29)
DEF(loadSelfSegment_watchpoint, -0x2E2C88)
DEF(loadSelfSegment_watchpoint_lr, -0x8DEE77)
DEF(decryptSelfBlock_watchpoint_lr, -0x8DEAFF)
DEF(decryptSelfBlock_epilogue, -0x8DEA42)
//DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8DE3C2) //403
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8DE3C9) //550
DEF(decryptMultipleSelfBlocks_epilogue, -0x8DE194)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8DF006)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8DEC99)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8DE6E6)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8DDF01)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8DF398)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x98508D)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x98562B)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x9855B8)
//DEF(sceSblPfsSetKeys, -0x985330) //403
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x9861B0) //550
DEF(sceSblServiceCryptAsync, -0x926F70)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x926F32)
DEF(copyin, -0x9CC830)
DEF(copyout, -0x9CC8E0)
DEF(crypt_message_resolve, -0x491770)
DEF(justreturn, -0xA0BA20)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xE7DE58)
DEF(pop_all_iret, -0xA0B852)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x9A86E8)
DEF(kernel_pmap_store, 0x2E2C848)
DEF(crypt_singleton_array, 0x2D71830)
DEF(security_flags, 0xAC8064)
DEF(targetid, 0xAC806D)
DEF(qa_flags, 0xAC8088)
DEF(utoken, 0xAC80F0)
DEF(mov_rax_cr0, -0xa12a61)
DEF(mov_cr0_rax, -0xa12a5c)
DEF(mov_rdi_cr2, -0xa0ec8a)
DEF(lgdt_rdi, -0x9cc140)
DEF(lidt_lldt, -0xa122b1)
DEF(ltr_ax, -0xa1228f)
DEF(kproc_shutdown, -0x9a6c40)
DEF(s_shutdown_final, 0x417c9e)
DEF(eventhandler_register, -0x53d300)
DEF(strlen_trap, -0x4603a8)
DEF(lapic_map, 0x28B3830)
#include "offset_list.txt"
END_FW()

START_FW(761)
DEF(allproc, 0x2859D50)
DEF(idt, 0x2E7FDF0)
DEF(gdt_array, 0x2E810D0)
DEF(tss_array, 0x2E82AD0)
DEF(pcpu_array, 0x2E94A00)
DEF(doreti_iret, -0xA0B7F3)
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x9CBF66)
DEF(rdmsr_start, -0xA0CF2A)
DEF(wrmsr_ret, -0xA0E2FC)
DEF(dr2gpr_start, -0xA12913)
DEF(gpr2dr_1_start, -0xA127FA)
DEF(gpr2dr_2_start, -0xA12707)
DEF(mov_cr3_rax_mov_ds, -0xa12369)
DEF(mov_rax_cr3, -0x3ADC3E)
DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0xA12B00)
DEF(mprotect_fix_start, -0x944D14)
DEF(mprotect_fix_end, mprotect_fix_start+6)

DEF(mmap_self_fix_1_start, -0x0)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, -0x0)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x890C00)
DEF(aslr_fix_end, aslr_fix_start+2)

DEF(sigaction_fix_start, -0x6EFFCD)
DEF(sigaction_fix_end, -0x6EFFB2)
DEF(sysents, 0x1B7260)
DEF(sysents_ps4, 0x1AECB0)
DEF(sysentvec, 0xE21B78)
DEF(sysentvec_ps4, 0xE21CF0)
DEF(sceSblServiceMailbox, -0x6AD3F0)
DEF(sceSblAuthMgrSmIsLoadable2, -0x8DF320)
DEF(mdbg_call_fix, -0x659169)
DEF(syscall_before, -0x8372BF)
DEF(syscall_after, -0x83729C)
DEF(malloc, -0xB5650)
DEF(M_something, 0x1457650)
DEF(loadSelfSegment_epilogue, -0x8DEC29)
DEF(loadSelfSegment_watchpoint, -0x2E2C88)
DEF(loadSelfSegment_watchpoint_lr, -0x8DEE77)
DEF(decryptSelfBlock_watchpoint_lr, -0x8DEAFF)
DEF(decryptSelfBlock_epilogue, -0x8DEA42)
//DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8DE3C2) //403
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8DE3C9) //550
DEF(decryptMultipleSelfBlocks_epilogue, -0x8DE194)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x8DF006)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x8DEC99)
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x8DE6E6)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8DDF01)
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x8DF398)
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x98508D)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x98562B)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x9855B8)
//DEF(sceSblPfsSetKeys, -0x985330) //403
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x9861B0) //550
DEF(sceSblServiceCryptAsync, -0x926F70)
DEF(sceSblServiceCryptAsync_deref_singleton, -0x926F32)
DEF(copyin, -0x9CC830)
DEF(copyout, -0x9CC8E0)
DEF(crypt_message_resolve, -0x491770)
DEF(justreturn, -0xA0BA20)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xE7DE58)
DEF(pop_all_iret, -0xA0B852)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x9A9750)
DEF(kernel_pmap_store, 0x2E2C848)
DEF(crypt_singleton_array, 0x2D71830)
DEF(security_flags, 0xAC8064)
DEF(targetid, 0xAC806D)
DEF(qa_flags, 0xAC8088)
DEF(utoken, 0xAC80F0)
DEF(mov_rax_cr0, -0xa12a61)
DEF(mov_cr0_rax, -0xa12a5c)
DEF(mov_rdi_cr2, -0xa0ec8a)
DEF(lgdt_rdi, -0x9cc140)
DEF(lidt_lldt, -0xa122b1)
DEF(ltr_ax, -0xa1228f)
DEF(kproc_shutdown, -0x9a60e8)
DEF(s_shutdown_final, 0x417c23)
DEF(eventhandler_register, -0x53d300)
DEF(strlen_trap, -0x4603a8)
DEF(lapic_map, 0x28B3830)
#include "offset_list.txt"
END_FW()

START_FW(800)
DEF(allproc, 0x2875d50) 
DEF(idt, 0x2eb3df0) 
DEF(gdt_array, 0x2eb50d0) 
DEF(tss_array, 0x2eb6ad0) 
DEF(pcpu_array, 0x2ec8a00)
DEF(doreti_iret, -0xa28c73) 
DEF(add_rsp_iret, doreti_iret - 7)
DEF(swapgs_add_rsp_iret, doreti_iret - 10)
DEF(rep_movsb_pop_rbp_ret, -0x9ec5c6) 
DEF(rdmsr_start, -0xa2a3aa) 
DEF(wrmsr_ret, -0xa2b77c) 
DEF(dr2gpr_start, -0xa2fd93)
DEF(gpr2dr_1_start, -0xa2fc7a)
DEF(gpr2dr_2_start, -0xa2fb87)
DEF(mov_cr3_rax_mov_ds, -0xa2f7e9)
DEF(mov_rax_cr3, -0x3b851f) 
DEF(nop_ret, wrmsr_ret + 2)
DEF(cpu_switch, -0xa2ff80)
DEF(mprotect_fix_start, -0x965114)
DEF(mprotect_fix_end, mprotect_fix_start+6)

DEF(mmap_self_fix_1_start, -0x0)
DEF(mmap_self_fix_1_end, mmap_self_fix_1_start+2)
DEF(mmap_self_fix_2_start, -0x0)
DEF(mmap_self_fix_2_end, mmap_self_fix_2_start+2)

DEF(aslr_fix_start, -0x8b12a1)
DEF(aslr_fix_end, aslr_fix_start+2)

DEF(sigaction_fix_start, -0x708600) 
DEF(sigaction_fix_end, -0x7085e4) 
DEF(sysents, 0x1a7db0)
DEF(sysents_ps4, 0x19f800)
DEF(sysentvec, 0xe21ca8)
DEF(sysentvec_ps4, 0xe21e20)
DEF(sceSblServiceMailbox, -0x6c48f0)
DEF(sceSblAuthMgrSmIsLoadable2, -0x900f10)
DEF(mdbg_call_fix, -0x66f489) 
DEF(syscall_before, -0x856fb1)
DEF(syscall_after, -0x856f8d) 
DEF(malloc, -0xbb320) 
DEF(M_something, 0x1457980) 
DEF(loadSelfSegment_epilogue, -0x9007eb)
DEF(loadSelfSegment_watchpoint, -0x2ecc08)
DEF(loadSelfSegment_watchpoint_lr, -0x900a57) 
DEF(decryptSelfBlock_watchpoint_lr, -0x9006bf)
DEF(decryptSelfBlock_epilogue, -0x9005fe) 
//DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8FFF81) //403
DEF(decryptMultipleSelfBlocks_watchpoint_lr, -0x8fff88) //550 **
DEF(decryptMultipleSelfBlocks_epilogue, -0x8ffd57)
DEF(sceSblServiceMailbox_lr_verifyHeader, -0x900bf7)
DEF(sceSblServiceMailbox_lr_loadSelfSegment, -0x90085f) 
DEF(sceSblServiceMailbox_lr_decryptSelfBlock, -0x90029d)
DEF(sceSblServiceMailbox_lr_decryptMultipleSelfBlocks, -0x8ffab3) 
DEF(sceSblServiceMailbox_lr_sceSblAuthMgrSmFinalize, -0x900f88) 
DEF(sceSblServiceMailbox_lr_verifySuperBlock, -0x9a5693)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_1, -0x9a5c0a)
DEF(sceSblServiceMailbox_lr_sceSblPfsClearKey_2, -0x9a5b9e)
//DEF(sceSblPfsSetKeys, -0x9A5930) //403
DEF(sceSblServiceMailbox_lr_npdrm_cmd_5, 0)
DEF(sceSblServiceMailbox_lr_npdrm_cmd_6, 0)
DEF(sceSblPfsSetKeys, -0x9a6780) // 550 **
DEF(sceSblServiceCryptAsync, -0x946f60) 
DEF(sceSblServiceCryptAsync_deref_singleton, -0x946f23) 
DEF(copyin, -0x9ece90)
DEF(copyout, -0x9ecf40) 
DEF(crypt_message_resolve, -0x49d9b0) 
DEF(justreturn, -0xa28ea0)
DEF(justreturn_pop, justreturn+8)
DEF(mini_syscore_header, 0xed4fa8)
DEF(pop_all_iret, -0xa28cd2)
DEF(pop_all_except_rdi_iret, pop_all_iret+4)
DEF(push_pop_all_iret, -0x9ca878) 
DEF(kernel_pmap_store, 0x2e48848) 
DEF(crypt_singleton_array, 0x2d8d830) 
DEF(security_flags, 0xAC3064) 
DEF(targetid, 0xAC306D)
DEF(qa_flags, 0xAC3088)
DEF(utoken, 0xAC30F0) 
DEF(mov_rax_cr0, -0xa2fee1) 
DEF(mov_cr0_rax, -0xa2fedc) 
DEF(mov_rdi_cr2, -0xa2c10a)
DEF(lgdt_rdi, -0x9ec7a0)
DEF(lidt_lldt, -0xa2f731)
DEF(ltr_ax, -0xa2f70f)
DEF(kproc_shutdown, -0x9c7b60)
DEF(s_shutdown_final, 0x379131)
DEF(eventhandler_register, -0x54c190)
DEF(strlen_trap, -0x46bcd8)
DEF(lapic_map, 0x28cf838)
#include "offset_list.txt"
END_FW()

void* dlsym(void*, const char*);

int set_offsets(void)
{
    uint32_t ver = r0gdb_get_fw_version() >> 16;
    switch(ver)
    {
#ifndef NO_BUILTIN_OFFSETS
    case 0x300: set_offsets_300(); break;
    case 0x310: set_offsets_310(); break;
    case 0x320: set_offsets_320(); break;
    case 0x321: set_offsets_321(); break;
    case 0x400: set_offsets_400(); break;
    case 0x402: set_offsets_402(); break;
    case 0x403: set_offsets_403(); break;
    case 0x450: set_offsets_450(); break;
    case 0x451: set_offsets_451(); break;
    case 0x500: set_offsets_500(); break;
    case 0x502: set_offsets_502(); break;
    case 0x510: set_offsets_510(); break;
    case 0x550: set_offsets_550(); break;
    case 0x600: set_offsets_600(); break;
    case 0x602: set_offsets_602(); break;
    case 0x650: set_offsets_650(); break;
    case 0x700: set_offsets_700(); break;
    case 0x701: set_offsets_701(); break;
    case 0x720: set_offsets_720(); break;
    case 0x740: set_offsets_740(); break;
    case 0x760: set_offsets_760(); break;
    case 0x761: set_offsets_761(); break;
    case 0x800: set_offsets_800(); break;
#endif
    default: return -1;
    }
    return 0;
}
